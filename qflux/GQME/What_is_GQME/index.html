
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../What_is_TTTFD/">
      
      
      <link rel="icon" href="../../../img/qflux_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Introduction to GQME - QFlux Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/collapse-sidebars.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  <script
  defer
  data-domain="qflux.batistalab.com"
  src="https://analytics.batistalab.com/js/script.js"
  
></script>

<script>
  window.plausible = window.plausible || function () { (window.plausible.q = window.plausible.q || []).push(arguments) };

  /* Register event handlers after documented loaded */
  document.addEventListener("DOMContentLoaded", function () {
    /* Set up search tracking */
    if (document.forms.search) {
      var query = document.forms.search.query;
      query.addEventListener("blur", function() {
        if (this.value) plausible("Search", { props: { search_term: this.value } });
      })
    }

    /* Set up feedback, i.e. "Was this page helpful?" */
    document$.subscribe(function () {
      var feedback = document.forms.feedback;
      if (typeof feedback === "undefined") return;

      /* Send feedback to Plausible */
      for (var button of feedback.querySelectorAll("[type=submit]")) {
        button.addEventListener("click", function (ev) {
          ev.preventDefault();

          var page = document.location.pathname;
          var value = this.getAttribute("data-md-value");
          console.log("[feedback] User clicked", { value });
          plausible(`Feedback: ${value}`);

          /* Disable form and show note, if given */
          feedback.firstElementChild.disabled = true;
          var note = feedback.querySelector(".md-feedback__note [data-md-value='" + value + "']");
          if (note) note.hidden = false;
        })

        /* Show feedback */
        feedback.hidden = false;
      }
    });
  });
</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-gqme" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="QFlux Docs" class="md-header__button md-logo" aria-label="QFlux Docs" data-md-component="logo">
      
  <img src="../../../img/qflux-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QFlux Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction to GQME
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/batistagroup/qflux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    batistagroup/qflux
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="QFlux Docs" class="md-nav__button md-logo" aria-label="QFlux Docs" data-md-component="logo">
      
  <img src="../../../img/qflux-logo.png" alt="logo">

    </a>
    QFlux Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/batistagroup/qflux" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    batistagroup/qflux
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contribution Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Closed_Systems/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Closed Systems
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Closed Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Closed_Systems/basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Anatomy of a Dynamics Simulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Closed_Systems/qho_example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Quantum Harmonic Oscillator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Closed_Systems/AT_basepair/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adenine-Thymine Base Pair
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Closed_Systems/spinchain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spin Chain Simulation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Closed_Systems/arbitrary_evo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arbitrary Hamiltonian Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Closed_Systems/cs_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Source Code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Open_Systems/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Open Systems
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Open Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Open_Systems/basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Open System Dynamics Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Open_Systems/spinchainOpen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spin Chain Demo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Open_Systems/spinhalfOpen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spin 1/2 Demo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Open_Systems/DoubleWellOpen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Double Well Demo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Open_Systems/os_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Source Code
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Variational_Methods/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Variational Methods
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Variational Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Variational_Methods/varQTE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VarQTE Demo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Variational_Methods/Vectorized_Adaptive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UAVQD for Open Systems
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Variational_Methods/trajectory_FMO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSE for Open Systems
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    GQME
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            GQME
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Introduction to GQME
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Introduction to GQME
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#derivation-of-the-nakajimazwanzig-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Derivation of the Nakajima–Zwanzig Equation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gqme-for-molecular-systems" class="md-nav__link">
    <span class="md-ellipsis">
      GQME for molecular systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GQME for molecular systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numerical-calculation-of-the-memory-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical calculation of the memory kernel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../What_is_TTTFD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to TT-TFD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spin_boson_GQME/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GQME for Spin-Boson model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quantum_GQME_dilation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantum Algorithm for GQME
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#derivation-of-the-nakajimazwanzig-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Derivation of the Nakajima–Zwanzig Equation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gqme-for-molecular-systems" class="md-nav__link">
    <span class="md-ellipsis">
      GQME for molecular systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GQME for molecular systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numerical-calculation-of-the-memory-kernel" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical calculation of the memory kernel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="introduction-to-gqme">Introduction to GQME</h1>
<p>In realistic physical and chemical processes, the system of interest is typically in contact with a thermal environment. This environment involves an enormous number of degrees of freedom—for example, think of the countless solvent molecules in a solution, on the order of Avogadro’s number—making it infeasible to solve the full quantum dynamics directly. However, we are not interested in the environment for its own sake, but only insofar as it influences the dynamics of the system.</p>
<p>One natural strategy is to derive an equation of motion for the system alone, by effectively tracing out the environmental degrees of freedom. Such closed-form equations of motion for the reduced system are known as quantum master equations.</p>
<p>The <strong>Generalized Quantum Master Equation (GQME)</strong> is a formally exact framework for simulating reduced quantum dynamics by projecting the full Liouville-von Neumann equation onto a relevant subsystem.</p>
<p>In this documentation, we focus on the well-known Nakajima-Zwanzig GQME (<a href="https://academic.oup.com/ptp/article/20/6/948/1930693">Nakajima, S. Prog. Theor. Phys. 1958</a>, <a href="https://doi.org/10.1063/1.1731409">Zwanzig, R. J.
Chem. Phys. 1960</a>):</p>
<div class="arithmatex">\[
\frac{d}{dt}\hat{\sigma}(t) = -\frac{i}{\hbar}\langle \mathcal{L}\rangle_{n}^{0}\hat{\sigma}(t) - \int_{0}^{t} d\tau\, \mathcal{K}(\tau)\hat{\sigma}(t - \tau) + \mathcal{I}(t)
\]</div>
<ul>
<li><span class="arithmatex">\(\hat{\sigma}\)</span>: reduced density matrix of the subsystem of interest.</li>
<li><span class="arithmatex">\(\langle \mathcal{L}\rangle_{n}^{0}\)</span>: the projected Liouvillian.</li>
<li><span class="arithmatex">\(\mathcal{K}(t)\)</span>: <strong>memory kernel</strong>, contains all the memory effects from the bath.</li>
<li><span class="arithmatex">\(\mathcal{I}(t)\)</span>: inhomogeneous term (often vanishes for factorized initial states).</li>
</ul>
<p>In the following, we briefly outline its derivation and the meaning of each term. For a detailed derivation, see <a href="https://doi.org/10.1021/acs.jctc.2c00892">this paper</a>.</p>
<h2 id="derivation-of-the-nakajimazwanzig-equation">Derivation of the Nakajima–Zwanzig Equation</h2>
<p>We begin with the quantum Liouville–von Neumann equation, which governs the time evolution of the total system density operator:</p>
<div class="arithmatex">\[
\frac{d}{dt} \hat{\rho}(t) = -\frac{i}{\hbar} [\hat{H}, \hat{\rho}(t)] \equiv -i \mathcal{L} \hat{\rho}(t),
\]</div>
<p>where <span class="arithmatex">\(\mathcal{L} \equiv \hbar^{-1}[\hat{H}, \cdots]\)</span> is the Liouvillian superoperator.</p>
<p>Now suppose we are only interested in a particular subsystem <span class="arithmatex">\(S\)</span> while treating the rest of the system as the surrounding environment <span class="arithmatex">\(B\)</span>. The total Hamiltonian can then be partitioned as:</p>
<div class="arithmatex">\[ \hat{H} = \hat{H}_{S} + \hat{H}_{B} + \hat{H}_{I} \]</div>
<p>where <span class="arithmatex">\(\hat{H}_{S}\)</span> and <span class="arithmatex">\(\hat{H}_{B}\)</span> are the system and bath Hamiltonians, respectively, and <span class="arithmatex">\(\hat{H}_{I}\)</span> denotes their interaction.</p>
<p>To derive an equation of motion for the subsystem alone, we introduce a projection operator <span class="arithmatex">\(\mathcal{P}\)</span>  that projects any operator onto the relevant subspace (i.e., the part we care about). Its complement is given by <span class="arithmatex">\(\mathcal{Q} = 1 - \mathcal{P}\)</span>.</p>
<p>Applying these projectors to both sides of the Liouville equation yields a pair of coupled equations:</p>
<div class="arithmatex">\[
\frac{d}{dt} \mathcal{P} \hat{\rho}(t) = -i \mathcal{P} \mathcal{L} \mathcal{P} \hat{\rho}(t) - i \mathcal{P} \mathcal{L} \mathcal{Q} \hat{\rho}(t),
\]</div>
<div class="arithmatex">\[
\frac{d}{dt} \mathcal{Q} \hat{\rho}(t) = -i \mathcal{Q} \mathcal{L} \mathcal{P} \hat{\rho}(t) - i \mathcal{Q} \mathcal{L} \mathcal{Q} \hat{\rho}(t).
\]</div>
<p>These equations describe how the projected components <span class="arithmatex">\(\mathcal{P} \hat{\rho}(t)\)</span> and <span class="arithmatex">\(\mathcal{Q} \hat{\rho}(t)\)</span> evolve and interact over time.</p>
<p>Formally solving the second equation gives:</p>
<div class="arithmatex">\[
\mathcal{Q} \hat{\rho}(t) = e^{-i \mathcal{Q} \mathcal{L} (t - t_{0})} \mathcal{Q} \hat{\rho}(t_{0})
- i \int_{t_{0}}^{t} d\tau\, e^{-i \mathcal{Q} \mathcal{L} (t - \tau)} \mathcal{Q} \mathcal{L} \mathcal{P} \hat{\rho}(\tau)
\]</div>
<p>Substituting this solution back into the first equation yields a formally closed equation for the relevant component <span class="arithmatex">\(\mathcal{P} \hat{\rho}(t)\)</span>:</p>
<div class="arithmatex">\[
\frac{d}{dt} \mathcal{P} \hat{\rho}(t) = -i \mathcal{P} \mathcal{L}\mathcal{P} \hat{\rho}(t)
- \int_{t_{0}}^{t} d\tau\, \mathcal{P} \mathcal{L} e^{-i \mathcal{Q} \mathcal{L}(t - \tau)} \mathcal{Q} \mathcal{L} \mathcal{P} \hat{\rho}(\tau)
- i \mathcal{P} \mathcal{L} e^{-i \mathcal{Q} \mathcal{L}(t - t_{0})} \mathcal{Q} \hat{\rho}(t_{0})
\]</div>
<p>This is the <strong>Nakajima-Zwanzig GQME</strong> with:</p>
<ul>
<li><span class="arithmatex">\(\hat{\sigma}(t) \equiv \mathcal{P} \hat{\rho}(t)\)</span>  the reduced density matrix,</li>
<li><span class="arithmatex">\(\mathcal{K}(t)\equiv \mathcal{P} \mathcal{L} e^{-i \mathcal{Q} \mathcal{L}(t - \tau)} \mathcal{Q} \mathcal{L} \mathcal{P}\)</span> the memory kernel,</li>
<li><span class="arithmatex">\(\hbar^{-1}\langle \mathcal{L}\rangle_{n}^{0}\equiv \mathcal{P} \mathcal{L} \mathcal{P}\)</span> the projected Liouvillian, which governs the system's unitary evolution in the absence of coupling to the bath,</li>
<li><span class="arithmatex">\(\mathcal{I}(t) \equiv - i \mathcal{P} \mathcal{L} e^{-i \mathcal{Q} \mathcal{L}(t - t_{0})} \mathcal{Q} \hat{\rho}(t_{0})\)</span> the inhomogeneous term.</li>
</ul>
<p>This equation serves as the formal foundation for computing reduced system dynamics with full inclusion of environment-induced memory effects.</p>
<h2 id="gqme-for-molecular-systems">GQME for molecular systems</h2>
<p>For molecular systems with an overall Hamiltonian of the following form:</p>
<div class="arithmatex">\[
\hat{H} = \sum_{j=1}^{N_{e}} \hat{H}_{j} (\hat{\mathbf{R}}, \hat{\mathbf{P}}) \left| j\right \rangle \left\langle j \right| + \sum_{\substack{j,k = 1 \\ k \neq j}}^{N_{e}} \hat{V}_{jk}(\hat{\mathbf{R}}) \left| j \right\rangle\left\langle k \right|
\]</div>
<p>Here, <span class="arithmatex">\(\hat{H}_{j} (\hat{\mathbf{R}},\hat{\mathbf{P}}) = \hat{\mathbf{P}}^2/2+ V_{j}(\hat{\mathbf{R}})\)</span> is the nuclear Hamiltonian when the system is in the electronic state <span class="arithmatex">\(| j \rangle\)</span>, with the index <span class="arithmatex">\(j\)</span> running over the <span class="arithmatex">\(N_{e}\)</span> electronic states;
<span class="arithmatex">\(\{ \hat{V}_{jk} (\hat{\mathbf{R}})| j \neq k \}\)</span> are coupling terms between electronic states;
and <span class="arithmatex">\(\hat{\mathbf{R}} = \{\hat{R}_1,\hat{R}_2,...,\hat{R}_{N_{n}} \}\)</span> and <span class="arithmatex">\(\hat{\mathbf{P}} = \{\hat{P}_1,\hat{P}_2,...,\hat{P}_{N_{n}} \}\)</span> are the mass-weighted position and momentum operators of the <span class="arithmatex">\(N_{n}\)</span> nuclear degrees of freedom (DOFs).</p>
<p>We choose the total initial state to be a product state:</p>
<div class="arithmatex">\[
\hat{\rho} (0) = \hat{\rho}_{n} (0) \otimes \hat{\sigma} (0)
\]</div>
<p>Here, <span class="arithmatex">\(\hat{\rho}_{n} (0)\)</span> is the initial density operator for the nuclear (bath) degrees of freedom, which is always taken to be in its own thermal equilibrium. Similarly, <span class="arithmatex">\(\hat{\sigma} (0) = \text{Tr}_n \{ \hat{\rho} (0)\}\)</span> is the reduced density operator that describes the initial state of the electronic DOFs. Here, <span class="arithmatex">\({\rm Tr}_n\{\cdot \}\)</span> denotes the partial trace over nuclear (bath) degrees of freedom.</p>
<p>Now define the projection operator as:</p>
<div class="arithmatex">\[\mathcal{P} \hat{\rho}(t) = \hat{\rho}_n(0) \otimes \text{Tr}_n\{\hat{\rho}(t)\}\]</div>
<p>This choice ensures that <span class="arithmatex">\(\mathcal{P} \hat{\rho}(0) = \hat{\rho}(0)\)</span>, which means the inhomogeneous term <span class="arithmatex">\(\mathcal{I}(t)\)</span> in the GQME vanishes.</p>
<p>With this projection operator, the definitions of the projected Liouvillian and the memory kernel become:</p>
<div class="arithmatex">\[
\langle \mathcal{L}\rangle_{n}^{0} = \text{Tr}_n \left\{ \hat{\rho}_n (0) {\cal L} \right\}
\]</div>
<div class="arithmatex">\[
\mathcal{K}(t) = \frac{1}{\hbar^2}\text{Tr}_n \Big\{ \mathcal{L} e^{-i \mathcal{QL} \tau / \hbar}\mathcal{QL} \hat{\rho}_n (0) \Big\} 
\]</div>
<p>It is important to note that all effects of the environment are fully encoded in the memory kernel. In other words, the challenge of simulating an open quantum system is reduced to accurately computing the memory kernel. Once the memory kernel is known, the GQME can be directly solved to obtain the time evolution of the reduced density matrix.</p>
<h3 id="numerical-calculation-of-the-memory-kernel">Numerical calculation of the memory kernel</h3>
<p>We now introduce a numerical approach for evaluating the memory kernel. Using the identity for the <span class="arithmatex">\(e^{-i \mathcal{QL} \tau / \hbar}\)</span> <a href="https://doi.org/10.1063/1.1624830">(Qiang Shi 2003)</a>,<a href="https://doi.org/10.1063/1.2218342">(Ming-Liang Zhang 2006)</a>,</p>
<div class="arithmatex">\[
e^{-i \mathcal{Q}\mathcal{L}t/\hbar}
= e^{-i \mathcal{L}t/\hbar}
+ \frac{i}{\hbar}\int_{0}^{t} \mathrm{d}\tau \,
e^{-i \mathcal{L}(t - \tau)/\hbar} \mathcal{P}\mathcal{L} e^{-i \mathcal{Q}\mathcal{L}\tau/\hbar}
\]</div>
<p>The memory kernel becomes</p>
<div class="arithmatex">\[
\mathcal{K}(t)
= i\dot{\mathcal{F}}(t)
- \frac{1}{\hbar}\mathcal{F}(t)\langle \mathcal{L}\rangle_{n}^{0}
+ i\int_{0}^{t} d\tau \, \mathcal{F}(t - \tau)\mathcal{K}(\tau)
\]</div>
<p>with the projection-free inputs (PFIs) <span class="arithmatex">\(\mathcal{F}(t)\)</span> and <span class="arithmatex">\(\dot{\mathcal{F}}(t)\)</span> defined as</p>
<div class="arithmatex">\[
\mathcal{F}(t)
= \frac{1}{\hbar}\mathrm{Tr}_n\bigl[\mathcal{L} e^{-i\mathcal{L}t/\hbar}\hat{\rho}_n(0)\bigr]
\]</div>
<div class="arithmatex">\[
\dot{\mathcal{F}}(t)
= -\frac{i}{\hbar^2}\mathrm{Tr}_n\bigl[\mathcal{L} e^{-i\mathcal{L}t/\hbar}\mathcal{L}\hat{\rho}_n(0)\bigr].
\]</div>
<p>The projection-free inputs can be related to the dynamics of the reduced density operator.
Note that the reduce density operator <span class="arithmatex">\(\hat{\sigma}(t)\)</span> can be formally written as</p>
<div class="arithmatex">\[
\hat{\sigma}(t)  = \mathcal{G}(t) \hat{\sigma}(0) = \mathrm{Tr}_n [e^{-i\mathcal{L}t/\hbar}\hat{\rho}_n(0)] \hat{\sigma}(0)
\]</div>
<p>therefore, <span class="arithmatex">\(\mathcal{F}(t) = i\dot{\mathcal{G}}(t)\)</span>. <span class="arithmatex">\(\mathcal{F}(t)\)</span> and <span class="arithmatex">\(\dot{\mathcal{F}}(t)\)</span> can be obtained through taking time-derivatives of <span class="arithmatex">\(\mathcal{G}(t)\)</span>.</p>
<p>The propagator <span class="arithmatex">\(\mathcal{G}(t)\)</span>, is a super-operator with the matrix
element <span class="arithmatex">\(\mathcal{G}_{jk,lm}(t)\)</span>, which can be defined by starting from initial state <span class="arithmatex">\(|l⟩⟨m| \otimes \hat{\rho}_n(0)\)</span>, measure the <span class="arithmatex">\(\sigma_{jk}(t)\)</span> at time <span class="arithmatex">\(t\)</span>.</p>
<p>These quantities can be computed using various existing numerical methods, such as the numerically exact tensor-train thermo-field dynamics (TT-TFD) approach introduced in  <a href="../What_is_TTTFD/">TT-TFD</a>. We will demonstrate the practical solution of the GQME using <code>qflux</code> in <a href="../spin_boson_GQME/">GQME for Spin-Boson model</a>.</p>
<h1 id="summary">Summary</h1>
<p>This example introduces the Generalized Quantum Master Equation (GQME) framework, which is an important approach for simulating open quantum system dynamics:</p>
<ul>
<li>
<p>The Nakajima–Zwanzig formalism is introduced as the theoretical foundation for deriving the GQME.</p>
</li>
<li>
<p>For chemically relevant molecular systems, we provide explicit definitions of each term in the GQME.</p>
</li>
<li>
<p>The memory kernel expression is expanded, illustrating how it can be computed numerically using various methods.</p>
</li>
</ul>
<p>The GQME framework thus provides a rigorous and versatile foundation for investigating quantum dynamics in systems coupled to realistic environments.</p>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="good">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="bad">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="good" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="bad" hidden>
              
              
                
              
              
              
                
                
              
              Thanks for your feedback!
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: GQME Documentation and User Guide">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                GQME Documentation and User Guide
              </div>
            </div>
          </a>
        
        
          
          <a href="../What_is_TTTFD/" class="md-footer__link md-footer__link--next" aria-label="Next: Introduction to TT-TFD">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Introduction to TT-TFD
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      CC-BY 4.0 &copy; 2025 Batista Group
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.footer", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../javascripts/collapse-sidebars.js"></script>
      
    
  </body>
</html>